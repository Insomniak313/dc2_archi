<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	<style type="text/css">
		table {
			margin: auto;
			margin-top: 50px;
		}
		td{
			border:1px solid black;
			margin: 0;
			width: 20px;
			height: 20px;
		}
	</style>
	<div id="conteneur_demineur"></div>
	<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
  	<script>


  		function tableauEnHtml(tableau) {
  			var html = '<table>';

  			for(var ligne = 0; ligne < tableau.length; ligne++) {
  				html = html + '<tr>';

  				for(var colonne = 0; colonne < tableau[ligne].length; colonne++) {

  					html = html + '<td>';

  					if(tableau[ligne][colonne].estUneMine) {
  						html = html + 'X';
					} else {
  						html = html + tableau[ligne][colonne].nbMineAlentours;
					}
  					// ECRIRE CONTENU CELLULE

					html = html + '</td>';
				}

				html = html + '</tr>';
			}
  			html = html + '</table>';

  			return html;
		}

		var nbLignes = 10;
		var nbColonnes = 15;

		var nbDeMinesAPlacer = 10;
		var tableauDeMines = [];

  		for(var i = 0; i < nbLignes ; i = i +1 ) {
  			tableauDeMines[i] = [];
  			for(var j = 0; j < nbColonnes; j++) {
  				var rand = Math.random();
  				var estMine = false;

  				if(rand < 0.5 && nbDeMinesAPlacer > 0) {
  					estMine = true;
  					nbDeMinesAPlacer = nbDeMinesAPlacer - 1;
  				}

  				tableauDeMines[i][j] = {};
  				tableauDeMines[i][j].estUneMine = estMine;
  			}
  		}

  		console.log(tableauDeMines);

  		for(var ligne = 0; ligne < tableauDeMines.length; ligne++) {
  			for(var colonne = 0; colonne < tableauDeMines[ligne].length; colonne++) {

  				if(tableauDeMines[ligne][colonne].estUneMine) {

				} else {

  					var cpt = 0;

  					// Est-ce qu'il existe une ligne au dessus
					if(typeof tableauDeMines[ligne - 1] !== 'undefined') {
						// Si la cellule au dessus est une mine, j'incremente mon compteur
						if(typeof tableauDeMines[ligne-1][colonne] !== 'undefined'
								&& tableauDeMines[ligne-1][colonne].estUneMine) {
							cpt = cpt + 1;
						}
						// Si la cellule au dessus à gauche est une mine, j'incremente mon compteur
						if(typeof tableauDeMines[ligne-1][colonne - 1] !== 'undefined'
							&& tableauDeMines[ligne-1][colonne - 1].estUneMine) {
							cpt = cpt + 1;
						}
						// Si la cellule au dessus à droite est une mine, j'incremente mon compteur
						if(typeof tableauDeMines[ligne-1][colonne + 1] !== 'undefined'
							&& tableauDeMines[ligne-1][colonne + 1].estUneMine) {
							cpt = cpt + 1;
						}
					}

					// Est-ce qu'il existe une ligne au dessous
					if(typeof tableauDeMines[ligne + 1] !== 'undefined') {
						// Si la cellule au dessous est une mine, j'incremente mon compteur
						if(typeof tableauDeMines[ligne+1][colonne] !== 'undefined'
								&& tableauDeMines[ligne+1][colonne].estUneMine) {
							cpt = cpt + 1;
						}
						// Si la cellule au dessous à gauche est une mine, j'incremente mon compteur
						if(typeof tableauDeMines[ligne+1][colonne - 1] !== 'undefined'
								&& tableauDeMines[ligne+1][colonne - 1].estUneMine) {
							cpt = cpt + 1;
						}
						// Si la cellule au dessous à droite est une mine, j'incremente mon compteur
						if(typeof tableauDeMines[ligne+1][colonne + 1] !== 'undefined'
								&& tableauDeMines[ligne+1][colonne + 1].estUneMine) {
							cpt = cpt + 1;
						}
					}

					// Si la cellule à droite est une mine, j'incremente mon compteur
					if(typeof tableauDeMines[ligne][colonne + 1] !== 'undefined'
						&& tableauDeMines[ligne][colonne + 1].estUneMine) {
						cpt = cpt + 1;
					}

					// Si la cellule à gauche est une mine, j'incremente mon compteur
					if(typeof tableauDeMines[ligne][colonne - 1] !== 'undefined'
							&& tableauDeMines[ligne][colonne - 1].estUneMine) {
						cpt = cpt + 1;
					}


					tableauDeMines[ligne][colonne].nbMineAlentours = cpt;
				}
			}
		}

  		$('#conteneur_demineur').html(tableauEnHtml(tableauDeMines));
  		// var nbDeMines = 10;

  		// $('td').each(function(index) {
  		// 	var rand = Math.random();
  		// 	if(rand < 0.5 && nbDeMines > 0) {
  		// 		$(this).html('X');
  		// 		nbDeMines = nbDeMines - 1;
  		// 	}

  		// });
  	</script>
</body>
</html>
