<!DOCTYPE html>
<html>
<head>
	<title></title>
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

<div id="test"></div>

<script
  src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
  integrity="sha256-4+XzXVhsDmqanXGHaHvgh1gMQKX40OUvDEBTu8JcmNs="
  crossorigin="anonymous"></script>

  <script type="text/javascript">

  	var taille = 8;
  	var tableau = [];
  	var estNoir = false;

  	for(var ligne = 0; ligne < taille ; ligne++) {
  		tableau[ligne] = [];
		for(var colonne = 0; colonne < taille ; colonne++) {
	  		tableau[ligne][colonne] = {};
	  		if(estNoir) {
	  			tableau[ligne][colonne].couleur = 'black'
	  		} else {
	  			tableau[ligne][colonne].couleur = 'white';
	  		}
	  		tableau[ligne][colonne].ligne = ligne;
	  		tableau[ligne][colonne].colonne = colonne;
	  		estNoir = !estNoir;
	  	}
	  	estNoir = !estNoir;
  	}



  	for(var ligne = 0; ligne < tableau.length ; ligne++) {

  		for(var colonne = 0; colonne < tableau[ligne].length; colonne++) {

	  		tableau[ligne][colonne].compte = visiter(tableau, ligne, colonne).length;

  		}
  	}



  	function parcours(tableau, celluleOrigine) {
      celluleOrigine.compte = 0;

      var cellulesVisitables = visiter(tableau, celluleOrigine.ligne, celluleOrigine.colonne);
      for(var cellule of cellulesVisitables) {
        cellule.compte = cellule.compte - 1;
      }

      var minimum = 1000;
      var celluleContenantMinimum = null;

      for(var cellule of cellulesVisitables) {
        if(cellule.compte < minimum && cellule.compte > 0) {
          celluleContenantMinimum = cellule;
          minimum = cellule.compte;
        }
      }

      return celluleContenantMinimum;
    }

  	var listePositionSuccessives = [];

  	function parcoursRecursif(tableau, celluleOrigine, listePositionSuccessives) {
      listePositionSuccessives.push(celluleOrigine);

      var celluleDestination = parcours(tableau, celluleOrigine);
      if(celluleDestination == null) {

      } else {
        return parcoursRecursif(tableau, celluleDestination, listePositionSuccessives);
      }
    }

    parcoursRecursif(tableau, tableau[2][1], listePositionSuccessives);

  	console.log(listePositionSuccessives);

  	function visiter(tableau, ligneCavalier, colonneCavalier) {

  	  var listeCellulesVisitables = [];

          // Est-ce que la ligne 2 cran au dessus existe
          if(typeof tableau[ligneCavalier-2] !== 'undefined') {
            // Est-ce que la cellule 2 ligne au dessus et 1 colonne a droite existe
            if(typeof tableau[ligneCavalier-2][colonneCavalier + 1] !== 'undefined') {
              listeCellulesVisitables.push(tableau[ligneCavalier-2][colonneCavalier + 1]);
            }

            // Est-ce que la cellule 2 ligne au dessus et 1 colonne a gauche existe
            if(typeof tableau[ligneCavalier-2][colonneCavalier - 1] !== 'undefined') {
              listeCellulesVisitables.push(tableau[ligneCavalier-2][colonneCavalier - 1]);
            }
          }
          // Est-ce que la ligne 1 cran au dessus existe
          if(typeof tableau[ligneCavalier-1] !== 'undefined') {
            // Est-ce que la cellule 1 ligne au dessus et 2 colonnes a droite existe
            if(typeof tableau[ligneCavalier-1][colonneCavalier + 2] !== 'undefined') {
              listeCellulesVisitables.push(tableau[ligneCavalier-1][colonneCavalier +2]);
            }

            // Est-ce que la cellule 1 ligne au dessus et 2 colonne a gauche existe
            if(typeof tableau[ligneCavalier-1][colonneCavalier - 2] !== 'undefined') {
              listeCellulesVisitables.push(tableau[ligneCavalier-1][colonneCavalier - 2]);
            }
          }
          // Est-ce que la ligne 2 cran au dessous existe
          if(typeof tableau[ligneCavalier+2] !== 'undefined') {
            // Est-ce que la cellule 2 ligne au dessous et 1 colonne a droite existe
            if(typeof tableau[ligneCavalier+2][colonneCavalier + 1] !== 'undefined') {
              listeCellulesVisitables.push(tableau[ligneCavalier+2][colonneCavalier +1]);
            }

            // Est-ce que la cellule 2 ligne au dessous et 1 colonne a gauche existe
            if(typeof tableau[ligneCavalier+2][colonneCavalier - 1] !== 'undefined') {
              listeCellulesVisitables.push(tableau[ligneCavalier+2][colonneCavalier - 1]);
            }
          }
          // Est-ce que la ligne 1 cran au dessous existe
          if(typeof tableau[ligneCavalier+1] !== 'undefined') {
            // Est-ce que la cellule 1 ligne au dessous et 2 colonnes a droite existe
            if(typeof tableau[ligneCavalier+1][colonneCavalier + 2] !== 'undefined') {
              listeCellulesVisitables.push(tableau[ligneCavalier+1][colonneCavalier+2]);
            }

            // Est-ce que la cellule 1 ligne au dessous et 2 colonne a gauche existe
            if(typeof tableau[ligneCavalier+1][colonneCavalier - 2] !== 'undefined') {
              listeCellulesVisitables.push(tableau[ligneCavalier+1][colonneCavalier - 2]);
            }
          }

        return listeCellulesVisitables;
    }

  	function tableauEnHtml(tab) {
  		var retour = '<table>';

  		for(var i=0; i < tab.length; i++) {
  			retour = retour + '<tr>';
  			for(var j=0; j<tab[i].length ; j++) {
				retour = retour + '<td id="' +tab[i][j].ligne + '_' + tab[i][j].colonne + '" class="' + tab[i][j].couleur + '">';
				retour = retour + tab[i][j].compte;
				retour = retour + '</td>';
  			}
  			retour = retour + '</tr>';
  		}

  		retour = retour + '</table>';
  		return retour;
  	}


  	var toto = tableauEnHtml(tableau);

  	$('#test').html(toto);

    for(var ligne = 0; ligne < taille ; ligne++) {
      for(var colonne = 0; colonne < taille ; colonne++) {
        tableau[ligne][colonne].elementJquery = $('#' + ligne + '_' + colonne);
      }
    }

  	for (var index in listePositionSuccessives) {

  	   var pos = listePositionSuccessives[index];


      setTimeout(function(){


        $('#' + pos.ligne + '_' + pos.colonne).attr('class', 'red');


        console.log('#' + pos.ligne + '_' + pos.colonne + ' en rouge');
      }, index * 1000);




    }



  </script>
</body>
</html>
